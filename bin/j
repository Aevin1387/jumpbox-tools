#!/bin/bash -x

TARGET=$1

function isip()
{
    [[ $1 =~ ^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$ ]]
    return $?
}

if isip $TARGET; then
    # FIXME: remove when new consul version is removed and use
    # reverse DNS
    TARGETNAME=`/usr/local/bin/consulkv services:catalog | grep $TARGET | jq .ServiceName`
    print $TARGETNAME
fi
